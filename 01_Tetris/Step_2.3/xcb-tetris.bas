REM -- TETRIS
REM -- An XC=BASIC tutorial game

CONST SCREENRAM = $0400
CONST COLORRAM = $d800

REM -- Clear the screen
MEMSET SCREENRAM, 1000, 32
REM -- Clear color RAM
MEMSET COLORRAM, 1000, 0

REM -- Set border and background color
POKE 53280, 13 : POKE 53281, 1

REM -- Switch to upper case
POKE 53272, 21

REM -- Disable SHIFT + Commodore key
POKE 657,128 

REM -- Draw the stage using a series of PRINT statements
PRINT "{GRAY}"
CURPOS 14, 3
PRINT "{REV_ON}{176}{195}{195}{195}{195}{195}{195}{195}{195}{195}{195}{174}{REV_OFF}"
FOR i! = 4 TO 23
  CURPOS 14, i!
  PRINT "{REV_ON}{194}{REV_OFF}          {REV_ON}{194}{REV_OFF}" : REM 10 spaces in the middle
NEXT
CURPOS 14, 24
PRINT "{REV_ON}{173}{195}{195}{195}{195}{195}{195}{195}{195}{195}{195}{189}{REV_OFF}";
CURPOS 0,0

REM -- Write texts
TEXTAT 27, 10, "level:"
TEXTAT 27, 13, "score:"
TEXTAT 27, 16, "hi:"
TEXTAT 27, 19, "next:"

REM -- Set color to green where numbers will be displayed
MEMSET COLORRAM + 467, 2, 5 : REM row 11, col 27, 2 chars
MEMSET COLORRAM + 587, 6, 5 : REM row 14, col 27, 6 chars
MEMSET COLORRAM + 707, 6, 5 : REM row 17, col 27, 6 chars

REM -- Shapes of all pieces in all rotations
DATA shapes[] = %0100010001000100, %0000111100000000, %0010001000100010, %0000000011110000, ~
                %0100010011000000, %1000111000000000, %0110010001000000, %0000111000100000, ~
                %0100010001100000, %0000111010000000, %1100010001000000, %0010111000000000, ~
                %1100110000000000, %1100110000000000, %1100110000000000, %1100110000000000, ~
                %0000011011000000, %1000110001000000, %0110110000000000, %0100011000100000, ~
                %0000111001000000, %0100110001000000, %0100111000000000, %0100011001000000, ~
                %0000110001100000, %0100110010000000, %1100011000000000, %0010011001000000

REM -- Piece color codes
DATA colors![] = 14, 6, 8, 7, 5, 4, 2